{"version":3,"file":"cart.js","sources":["../src/js/helpers.js","../src/cart.js"],"sourcesContent":["// Розрахунок загальної суми та кількості товарів у кошику\nexport const calculateTotal = (items) => {\n  let totalItems = 0;\n  let totalPrice = 0;\n\n  items.forEach(item => {\n    totalItems += 1;\n    totalPrice += item.price || 0;\n  });\n\n  return { totalItems, totalPrice };\n};\n\n// Перевірка, чи товар є в сховищі\nexport const isInStorage = (key, id) => {\n  const items = JSON.parse(localStorage.getItem(key)) || [];\n  return items.some(item => item.id === id);\n};","//Логіка сторінки Cart\nimport { getFromStorage, getItemsCount } from './js/storage.js';\nimport { refs } from './js/refs.js';\nimport { renderProducts, renderEmptyMessage } from './js/render-function.js';\nimport { fetchProductById } from './js/products-api.js';\nimport { openModal } from './js/modal.js';\nimport { calculateTotal } from './js/helpers.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const cartItems = getFromStorage('cart');\n  if (cartItems.length === 0) {\n    renderEmptyMessage(refs.productsList, 'Your cart is empty.');\n    // refs.totalContainer.innerHTML = '';\n    // return;\n  }\n\n  renderProducts(cartItems, refs.productsList);\n\n  const { totalItems, totalPrice } = calculateTotal(cartItems);\n  refs.summaryItemsCount.textContent = totalItems;\n  refs.summaryItemsPrice.textContent = Number(totalPrice.toFixed(2));\n});\n\nlet currentProduct = null;\n\nexport const openCartModal = (product) => {\n  currentProduct = product;\n\n  const isInCart = isInStorage('cart', product.id);\n\n  refs.modalContent.innerHTML = `\n    <h2>${product.title}</h2>\n    <img src=\"${product.thumbnail}\" alt=\"${product.title}\">\n    <p>${product.description}</p>\n    <button id=\"cart-btn\">\n      ${isInCart ? 'Remove from Cart' : 'Add to Cart'}\n    </button>\n  `;\n\n  refs.modal.classList.add('modal--is-open');\n  document.addEventListener('keydown', handleEscapeKey);\n\n  // Додаємо слухача подій на кнопку\n  document.getElementById('cart-btn').addEventListener('click', handleCartToggle);\n  updateCartCounter();\n};\n\nconst handleEscapeKey = (e) => {\n  if (e.key === 'Escape') closeModal();\n};\n\nexport const closeModal = () => {\n  refs.modal.classList.remove('modal--is-open');\n  document.removeEventListener('keydown', handleEscapeKey);\n};\n\nfunction isInStorage(key, id) {\n  return getFromStorage(key).some(item => item.id === id);\n}\n\nfunction handleCartToggle() {\n  toggleItemInStorage('cart', currentProduct);\n  updateCartButton();\n  updateCartCounter();\n}\n\nfunction updateCartButton() {\n  const cartBtn = document.getElementById('cart-btn');\n  const isInCart = isInStorage('cart', currentProduct.id);\n  cartBtn.textContent = isInCart ? 'Remove from Cart' : 'Add to Cart';\n}\n\nfunction updateCartCounter() {\n  const cartItems = getFromStorage('cart');\n  const count = cartItems.length;\n  const total = cartItems.reduce((sum, item) => sum + item.price, 0);\n\n  // Оновлення в шапці\n  const navCount = document.querySelector('.nav__count');\n  if (navCount) navCount.textContent = count;\n\n  // Оновлення в aside\n  const countEl = document.querySelector('[data-count]');\n  const priceEl = document.querySelector('[data-price]');\n  if (countEl) countEl.textContent = count;\n  if (priceEl) priceEl.textContent = `$${total}`;\n}"],"names":["calculateTotal","items","totalItems","totalPrice","item","cartItems","getFromStorage","renderEmptyMessage","refs","renderProducts"],"mappings":"8EACO,MAAMA,EAAkBC,GAAU,CACvC,IAAIC,EAAa,EACbC,EAAa,EAEjB,OAAAF,EAAM,QAAQG,GAAQ,CACpBF,GAAc,EACdC,GAAcC,EAAK,OAAS,CAChC,CAAG,EAEM,CAAE,WAAAF,EAAY,WAAAC,EACvB,ECHA,SAAS,iBAAiB,mBAAoB,IAAM,CAClD,MAAME,EAAYC,EAAe,MAAM,EACnCD,EAAU,SAAW,GACvBE,EAAmBC,EAAK,aAAc,qBAAqB,EAK7DC,EAAeJ,EAAWG,EAAK,YAAY,EAE3C,KAAM,CAAE,WAAAN,EAAY,WAAAC,CAAY,EAAGH,EAAeK,CAAS,EAC3DG,EAAK,kBAAkB,YAAcN,EACrCM,EAAK,kBAAkB,YAAc,OAAOL,EAAW,QAAQ,CAAC,CAAC,CACnE,CAAC"}